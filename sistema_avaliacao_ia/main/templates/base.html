{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Predicto{% endblock %}</title>
    
    <link rel="stylesheet" href="{% static 'css/auth.css' %}">
    <link rel="stylesheet" href="{% static 'css/layout.css' %}">
    
    {% block extra_head %}{% endblock %}
</head>
<body>

    <nav class="sidebar">
        <a href="{% url 'main:comp' %}" class="sidebar-header">Predicto</a>
        
        <ul class="sidebar-nav">
            <li><a href="{% url 'main:comp' %}">Competições</a></li>
            <li><a href="{% url 'main:user-profile' %}">Perfil</a></li>
            <li><a href="{% url 'main:ranking' %}">Ranking</a></li>
        </ul>

        <div class="sidebar-footer">
            <p>{{ user_name }}</p>
            <a href="{% url 'main:logout' %}">
                <button type="button" style="width: 100%;">Logout</button>
            </a>
        </div>
    </nav>

        <main class="main-content">
            {% block content %}
            {% endblock %}
        </main>
    </div>
    
    {% block extra_js %}{% endblock %}

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const messages = document.querySelectorAll('.messages li');
            if (messages.length > 0) {
                setTimeout(function() {
                    messages.forEach(function(msg) {
                        // Adiciona uma transição suave de opacidade
                        msg.style.transition = "opacity 0.5s ease";
                        msg.style.opacity = "0";
                        
                        // Remove o elemento do DOM depois que a transição terminar
                        setTimeout(function() {
                            msg.remove();
                            // Se a lista ficar vazia, remove o container ul também
                            const list = document.querySelector('.messages');
                            if (list && list.children.length === 0) {
                                list.remove();
                            }
                        }, 500);
                    });
                }, 5000); // 5000 milissegundos = 5 segundos
            }
        });

        (function() {
            const idleDuration = 900000; 
            let idleTimer;

            const resetTimer = () => {
                clearTimeout(idleTimer);
                idleTimer = setTimeout(() => {
                    alert("Sua sessão expirou por inatividade.");
                    window.location.href = "{% url 'main:logout' %}";
                }, idleDuration);
            };

            window.onload = resetTimer;
            window.onmousemove = resetTimer;
            window.onmousedown = resetTimer;
            window.ontouchstart = resetTimer;
            window.onclick = resetTimer;
            window.onkeypress = resetTimer;
            window.addEventListener('scroll', resetTimer, true);

        })();
    </script>
</body>
</html>